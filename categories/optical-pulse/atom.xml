<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: optical pulse | Blog | OpenEnergyMonitor]]></title>
  <link href="https://blog.openenergymonitor.org/categories/optical-pulse/atom.xml" rel="self"/>
  <link href="https://blog.openenergymonitor.org/"/>
  <updated>2017-01-25T16:34:53+00:00</updated>
  <id>https://blog.openenergymonitor.org/</id>
  <author>
    <name><![CDATA[Glyn Hudson]]></name>
    <email><![CDATA[support@openenergymonitor.zendesk.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Pulse counting with the RFM69PI and RaspberryPi EmonBase basestation]]></title>
    <link href="https://blog.openenergymonitor.org/2015/09/pulse-counting-with-rfm69pi-and/"/>
    <updated>2015-09-06T21:08:00+00:00</updated>
    <id>https://blog.openenergymonitor.org/2015/09/pulse-counting-with-rfm69pi-and</id>
    <content type="html"><![CDATA[<p>The latest version of the RFMPi Adapter board made much of the spare digital and analog IO available for use directly on the RFMPi adapter board. D3 is one of the digital inputs available and can have an interrupt attached (INT 1) which makes it useful for pulse counting.<br /><br />By connecting a<a href="http://shop.openenergymonitor.com/optical-utility-meter-led-pulse-sensor/"> optical pulse sensor</a> directly to the <a href="http://shop.openenergymonitor.com/emonbase-raspberry-pi-web-connected-base-station/">rfm69pi adapter board</a> this can make a relatively low cost solution for internet connected pulse counting (or local logging to emoncms running on the raspberrypi). <br /><br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://3.bp.blogspot.com/-EScDwqHXgyw/VeylN7yKW2I/AAAAAAAAT2w/HzWr5pXAwMg/s1600/rfmpi_pulse.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="223" src="http://3.bp.blogspot.com/-EScDwqHXgyw/VeylN7yKW2I/AAAAAAAAT2w/HzWr5pXAwMg/s400/rfmpi_pulse.JPG" width="400" /></a>&lt;/div&gt;<br /><b>Setup</b><br /><br />1) The RJ45 connector on the optical pulse counter needs to be removed and individual wires exposed. Connect the red wire to 3.3V, the black wire to GND and the blue wire to D3:<br /><br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-svvRwhAQZc4/VeylOJ16QRI/AAAAAAAAT20/2s3CJ9OcOlw/s1600/rfmpi_pulse_connections.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="http://4.bp.blogspot.com/-svvRwhAQZc4/VeylOJ16QRI/AAAAAAAAT20/2s3CJ9OcOlw/s400/rfmpi_pulse_connections.JPG" width="400" /></a>&lt;/div&gt;<br />2) To use the rfm69pi adapter with pulse counting the pulse counting firmware needs to be uploaded to the rfm69pi adapter board, the steps to upload this firmware are:<br />&lt;ol&gt;&lt;li&gt;SSH into your raspberrypi running the standard OpenEnergyMonitor image.&lt;/li&gt;&lt;li&gt;Place raspberrypi in write mode: <br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$ rpi-rw</span>&lt;/li&gt;&lt;li&gt;Stop emonhub: <br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$ sudo service emonhub stop</span>&lt;/li&gt;&lt;li&gt;Pull in latest changes to RFM2PI git directory: <br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$ cd RFM2PI<br />$ git pull</span>&lt;/li&gt;&lt;li&gt;Upload pulse counting firmware:<br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$ avrdude -v -c arduino -p ATMEGA328P -P /dev/ttyAMA0 -b 38400 -U flash:w:/home/pi/RFM2Pi/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328_Pulse/RFM69CW_RF12_Demo_ATmega328_Pulse.cpp.hex</span>&lt;/li&gt;&lt;li&gt;Start emonhub:<br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$ sudo service emonhub start</span>&lt;/li&gt;&lt;/ol&gt;Next login to the local emoncms installation on the raspberrypi and navigate to the emonhub.conf editor. Add the following node definition in the nodes section of emonhub.conf:<br /><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">[[15]]<br />    nodename = rfmpi_pulse<br />    firmware = RFM69CW_RF12_Demo_ATmega328_Pulse<br />    hardware = rfm69pi<br />    [[[rx]]]<br />       names = power,count<br />       datacodes = h,L<br />       scales = 1,1<br />       units = W,Wh </span><br /><br />The pulse count is accumulated on the rfm69pi until the rfm69pi is reset either by an outage or by turning off and on the power.<br /><br />To record the total accumulated pulse count in emoncms use the  wh_accumulator input process which detects resets continuing the total  pulse count accumulation from the last value before the reset.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Optical pulse counting with the EmonTH]]></title>
    <link href="https://blog.openenergymonitor.org/2015/09/optical-pulse-counting-with-emonth/"/>
    <updated>2015-09-02T12:53:00+00:00</updated>
    <id>https://blog.openenergymonitor.org/2015/09/optical-pulse-counting-with-emonth</id>
    <content type="html"><![CDATA[<style type="text/css">p { margin-bottom: 0.25cm; line-height: 120%; }</style>
<p><br />&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;In addition to temperature and humidity sensing the <a href="http://openenergymonitor.org/emon/modules/emonTH">EmonTH</a> has a digital input (with interrupt) that can be used for pulse counting.   &lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;This can be used for <a href="http://openenergymonitor.org/emon/buildingblocks/introduction-to-pulse-counting">wired pulse counting</a> or with the <a href="http://shop.openenergymonitor.com/optical-utility-meter-led-pulse-sensor/">Optical LED pulse sensor</a>.&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;To use the Optical LED Pulse sensor the easiest way is to remove the RJ45 connector and then strip back the black sheathing to reveal the red (3.3V power), black (GND) and blue (pulse) wires.&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;Connect the red wire to the 3.3V terminal, the black wire to the GND terminal and the blue wire to the terminal labelled D3 (top) or IRQ1/D3 Pulse Counting (bottom of the board).<br /><br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://wiki.openenergymonitor.org/images/thumb/Emonth_pulse.jpg/1600px-Emonth_pulse.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://wiki.openenergymonitor.org/images/thumb/Emonth_pulse.jpg/1600px-Emonth_pulse.jpg" height="347" width="640" /></a>&lt;/div&gt;<br />&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://3.bp.blogspot.com/-Mq6ZFJuLqcc/VebtplQo9rI/AAAAAAAAT14/NtBwwglgdxo/s1600/SAM_1228.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://3.bp.blogspot.com/-Mq6ZFJuLqcc/VebtplQo9rI/AAAAAAAAT14/NtBwwglgdxo/s320/SAM_1228.JPG" width="320" /></a>&lt;/div&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://2.bp.blogspot.com/-JKBIFoch2cU/VebtpvkXfcI/AAAAAAAAT18/4NYrBdD0Nlo/s1600/SAM_1229.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://2.bp.blogspot.com/-JKBIFoch2cU/VebtpvkXfcI/AAAAAAAAT18/4NYrBdD0Nlo/s320/SAM_1229.JPG" width="320" /></a>&lt;/div&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://1.bp.blogspot.com/-rIL3qPNNzt0/VebtpevfL6I/AAAAAAAAT10/ooswSPyzU_g/s1600/SAM_1230.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" src="http://1.bp.blogspot.com/-rIL3qPNNzt0/VebtpevfL6I/AAAAAAAAT10/ooswSPyzU_g/s640/SAM_1230.JPG" width="640" /></a>&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="line-height: 100%; margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;There are two firmware examples available for the EmonTH for pulse counting, the first is for Pulse counting in addition to DHT22 Temperature + Humidity sensing or DS18B20 temperature sensing:<br /><a href="https://github.com/openenergymonitor/emonTH/tree/master/emonTH_DHT22_DS18B20_RFM69CW_Pulse">https://github.com/openenergymonitor/emonTH/tree/master/emonTH_DHT22_DS18B20_RFM69CW_Pulse</a><br /><br />The second is for pulse counting only if the temperature and humidity sensing is not needed:<br /><a href="https://github.com/openenergymonitor/emonTH/tree/master/emonTH_pulse_lowpower">https://github.com/openenergymonitor/emonTH/tree/master/emonTH_pulse_lowpower</a><br /><br />To upload these firmware examples you will need the <a href="http://openenergymonitor.org/emon/buildingblocks/setting-up-the-arduino-environment">Arduino IDE and libraries installed</a> and a <a href="http://shop.openenergymonitor.com/programmer-usb-to-serial-uart/">USB to serial programmer</a> to upload the firmware to the EmonTH.<br /><br />The pulse count is accumulated on the EmonTH until the EmonTH is reset either by an outage or by turning off and on the power.<br /><br />To record the total accumulated pulse count in emoncms use the wh_accumulator input process which detects resets continuing the total pulse count accumulation from the last value before the reset.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Optical Utility Meter LED Pulse Sensor]]></title>
    <link href="https://blog.openenergymonitor.org/2015/06/optical-utility-meter-led-pulse-sensor/"/>
    <updated>2015-06-19T11:19:00+00:00</updated>
    <id>https://blog.openenergymonitor.org/2015/06/optical-utility-meter-led-pulse-sensor</id>
    <content type="html"><![CDATA[<table cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-gPDYR47gDXw/VYP4XG7lgpI/AAAAAAABLK8/rdKGFA3BKzw/s1600/optical_pulse.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="263" src="http://3.bp.blogspot.com/-gPDYR47gDXw/VYP4XG7lgpI/AAAAAAABLK8/rdKGFA3BKzw/s320/optical_pulse.JPG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Optical Utility Meter LED Pulse Sensor attached to meter via removable sticky pad</td></tr></tbody></table>
<p><br />We have just taken delivery of a batch of custom made Optical Utility Meter LED Pulse Sensor units. We’re very excited about these new sensors, they will enable the emonPi and emonTx to interface directly with Utility Meters measuring exactly the amount of energy being measured by the utility meter.<br /><br />The Optical Pulse Sensor works by sensing the LED pulse output from utility meters. Each pulse corresponds to a certain amount of energy passing through the meter. The amount of energy each pulse corresponds to depends on the meter. By counting these pulses the meters KWh value can be calculated.<br /><br />Unlike clip-on CT based monitoring pulse counting is measuring exactly what the utility meter is measuring i.e. what you get billed for. The pulse counting cannot provide an instantaneous power reading like CT based can. Where possible we recommend using pulse counting in conjunction with CT monitoring. The emonPi and emonTx can simultaneously perform pulse counting and CT based monitoring.<br /><br />In the future we plan to look at how the pulse counting energy value can be used to calibrate the CT based power calculations.<br /><br />The Optical Pulse sensor will work plug-and-play with emonPi / emonTx connecting via RJ45 socket, older units will require a firmware update. See documentation page for update instructions.<br /><br /><a href="http://openenergymonitor.org/emon/buildingblocks/opticalpulsesensor">Optical Pulse Sensor Documentation Page</a><br /><br /><a href="http://shop.openenergymonitor.com/optical-utility-meter-led-pulse-sensor/">Optical Pulse Sensor is now available to purchase from the OpenEnergyMonitor online shop</a><br /><br />If you have backed us on Kickstarter or have purchased an emonPi from us as a thank you for your support we would like to offer you 20% off the Optical Pulse Sensor, use code PYN5031978E9T at checkout (valid until 1st July 2015).<br /><br /><br /><br />&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-w_OfopSMeKI/VYP4ZTLDvUI/AAAAAAABLLE/3SL_h8AKwKo/s1600/optical_pulse_emonpi.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="473" src="http://4.bp.blogspot.com/-w_OfopSMeKI/VYP4ZTLDvUI/AAAAAAABLLE/3SL_h8AKwKo/s640/optical_pulse_emonpi.JPG" width="640" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Pulse sensor installed &amp; connected to emonPi via RJ45&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/vq5EmMRrOY0/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/vq5EmMRrOY0?feature=player_embedded" width="320"&gt;&lt;/iframe&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;Green LED on sensor flashes in sync with LED pulse&lt;/div&gt;<br />&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-n-ULDY85GEE/VYP5cqaTqdI/AAAAAAABLLM/urTCz9A46Cw/s1600/IMG_20150618_103617229.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="225" src="http://4.bp.blogspot.com/-n-ULDY85GEE/VYP5cqaTqdI/AAAAAAABLLM/urTCz9A46Cw/s400/IMG_20150618_103617229.jpg" width="400" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Big box of pulse sensors arrived today! :-) &lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br /></p>
]]></content>
  </entry>
  
</feed>
