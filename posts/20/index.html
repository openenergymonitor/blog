<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="/posts/20/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Blog | OpenEnergyMonitor">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="/posts/20/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="Blog | OpenEnergyMonitor">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />



    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:light,bold&amp;subset=Latin" rel="stylesheet"> <!-- Ubuntu font -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  </head>

<style>

@font-face {
  font-family: "oemFont";
  src: url(/font/Ubuntu-OEM-Light.ttf)
}

html, body {
  margin: 0; height: 100vh;
}

html {
  min-height: 100vh;
}

html, body {
  word-wrap: break-word;
  font-family: "oemFont", sans-serif;
}

a:visited, .a:hover, a:focus, a {
  color: #44b3e2;
}

.meta.clearfix {
  overflow-x: hidden;
}

.communityWrapper {
  position: relative;
  box-sizing: border-box;
  margin: 0 auto;
  width: 100%;
  height: 42px;
}

@media (min-width: 1080px) {
  .communityWrapper {
  width: 1080px;
  }
}

@media screen and (max-width: 400px) {
  .oemWrap {
  display: none;
  }
}

.fa-navicon {
  display: none;
  cursor: pointer;
  font-size: 30px;
  line-height: 42px;
  position: absolute;
  left: 0;
  color: #ffffff;
  padding-left: 12px;
  z-index: 9997;
}

@media screen and (max-width: 1079px) {
  .fa-navicon {
  display: inline-block;
  }
}

.titleHolder {
  position: relative;
  top: 0;
  width: 100%;
  height: 42px;
  background-color: #44b3e2;
  overflow: hidden;
  -webkit-box-shadow: 0 -2px 4px 2px #000;
  -moz-box-shadow: 0 -2px 4px 2px #000;
  box-shadow: 0 -2px 4px 2px #000;
}

.titleIcon {
  position: absolute;
  height: 42px;
  padding: 0 0 0 7px;
  text-align: center;
  line-height: 42px;
  color: #ffffff;
  vertical-align: top;
}

  .titleIcon i {
    vertical-align: middle;
    font-size: 32px;
    line-height: 42px;
  }

.thisTitle {
  position: absolute;
  box-sizing: border-box;
  left: 42px;
  right: 0;
  height: 42px;
  padding: 5px 0 5px 0;
  text-align: left;
  color: #ffffff;
  line-height: normal;
  vertical-align: top;
}

  .thisTitle a {
    position: absolute;
    top: 0;
    color: #ffffff;
  }

@media screen and (max-width: 1079px) {
  .titleIcon {
    left: auto;
    right: 0;
    padding: 0 7px 0 0;
  }

  .thisTitle {
    right: 42px;
    left: 0;
    text-align: right;
  }

    .thisTitle a {
      padding-right: 0;
    }
}

.thisTitle-top {
  top: 0;
  height: 60%;
  font-size: 18px;
}

.thisTitle-bottom {
  bottom: 0;
  height: 40%;
  font-size: 12px;
}

.navigation {
  position: absolute;
  display: inline-block;
  top: 0;
  right: 0;
  margin-right: 6px;
  height: 42px;
  min-width: 774px;
  overflow: visible;
  padding-right: 7px;
  z-index: 20;
  box-sizing: content-box;
}

@media screen and (min-width: 1080px) {
  .navigation {
  position: relative;
  float: right;
  display: inline-block;
  margin: 0;
  }
}

.navigation ul {
  list-style-type: none;
  float: right;
  top: 0;
  margin: 0;
  padding: 0;
  height: 100%;
  display: block;
}

.navigation ul li {
  float: left;
  background-color: #44b3e2;
}

.navigation ul li a {
  display: block;
  line-height: 42px;
  font-family: "oemFont", sans-serif;
  font-size: 16px;
  text-align: center;
  padding-left: 10px;
  padding-right: 10px;
  color: #ffffff;
}

.menuFreeze {
  height: 100%;
  overflow: hidden;
}

/* Navigation on smaller screens... */

@media screen and (max-width: 1079px) {
.navigation {
  position: fixed;
  display: none;
  top: 0;
  left: 0;
  height: 100vh;
  margin: 0;
  width: 0;
  font-size: 20px;
  background-color: #44b3e2;
  color: #ffffff;
  box-sizing: border-box;
  overflow: auto;
  min-width: 0;
  padding-right: 0;
  z-index: 99999999;
}

  .navigation ul {
    list-style-type: none;
    margin: 0;
    padding-top: 0;
  }

  .navigation ul li a {
    box-sizing: border-box;
    font-family: "oemFont", sans-serif;
    font-size: 20px;
    display: block;
    color: #ffffff;
    padding: 0 20px 0 20px;
    height: 12.5vh;
    line-height: 12.5vh;
    min-width: 180px;
    text-align: left;
  }

  .navigation ul li .fa {
    min-width: 25px;
  }
}

@media (max-width: 1079px) and (min-height: 550px) {
  .navigation ul li a {
    height: 68.75px;
    line-height: 68.75px;
  }
}

@media (max-width: 1079px) and (max-height: 200px) {
  .navigation ul li a {
    height: 25px;
    line-height: 25px;
  }
}

@media screen and (min-width: 1080px) {
  .navigation ul li:nth-child(1) {
    width: 88px;
  }
  .navigation ul li:nth-child(2) {
    width: 86px;
  }
  .navigation ul li:nth-child(3) {
    width: 92px;
  }
  .navigation ul li:nth-child(4) {
    width: 123px;
  }
  .navigation ul li:nth-child(5) {
    width: 133px;
  }
  .navigation ul li:nth-child(6) {
    width: 76px;
  }
  .navigation ul li:nth-child(7) {
    width: 80px;
  }
  .navigation ul li:nth-child(8) {
    width: 96px;
  }
}

.blackOut {
  position: fixed;
  display: none;
  top: 0;
  right: 0;
  height: 100vh;
  width: 100%;
  background-color: rgba(0,0,0,0.5);
  overflow: hidden;
  cursor: pointer;
  z-index:9998;
}

.actoemLink {
  background-color: #368fb4 !important;
}

.actoemLink a {
  color: #ffffff !important;
}

.searchBox {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  background-color: rgba(0,0,0,0.8);
  color: #fff;
  display: none;
  cursor: pointer;
  z-index: 9999999999999;
}

.searchBox form {
  margin: auto;
}

.searchBox input[type=submit] {
  cursor: pointer;
  padding: 10px;
  font-size: 20px;
  font-weight: bold;
  background-color: #44b3e2;
  color: #fff;
  border: none;
  -webkit-transition: background-color 500ms linear;
  -ms-transition: background-color 500ms linear;
  transition: background-color 500ms linear;
}

.searchBox input[type=submit]:hover {
  background-color: #77c8ea;
}

.searchBox input[type=text] {
  padding: 10px;
  font-size: 20px;
  border: none;
}

.searchText {
  width: 0;
}

.searchIcon {
  cursor: pointer;
}

.fa {
  text-shadow: 2px 2px 2px rgba(150, 150, 150, 0.5);
}

</style>

<body >




<div class="titleHolder">
  <div class="communityWrapper">
    <i class="fa fa-navicon"></i>
    <a href="/">
      <div class="titleIcon">
				<i aria-hidden="true" class="fa fa-bullhorn"></i>
			</div>
			<div class="thisTitle">
			  <div class="thisTitle-top">
        		<b>Blog</b>
				</div>
				<div class="thisTitle-bottom">
          Open<b>EnergyMonitor</b>
				</div>
			</div>
		</a>
    <div id="siteLinks" class="navigation">
      <ul>
        <li title="the homepage of OpenEnergyMonitor">
          <a href="https://openenergymonitor.org">
            <i class="fa fa-home" aria-hidden="true"></i><span class="navname">&nbsp;Home</span>
          </a>
        </li>
        <li title="a user guide for the OpenEnergyMonitor system">
          <a href="https://guide.openenergymonitor.org">
            <i class="fa fa-book" aria-hidden="true"></i><span class="navname">&nbsp;Guide</span>
          </a>
        </li>
        <li title="general information about energy monitoring, diversion and sustainability">
          <a href="https://learn.openenergymonitor.org">
            <i class="fa fa-mortar-board" aria-hidden="true"></i><span class="navname">&nbsp;Learn</span>
          </a>
        </li>
        <li title="a definitive list of resources for OpenEnergyMonitor hardware">
          <a href="https://guide.openenergymonitor.org/technical/resources/">
            <i class="fa fa-list-alt" aria-hidden="true"></i><span class="navname">&nbsp;Resources</span>
          </a>
        </li>
        <li title="the openenergymonitor forum">
          <a href="https://community.openenergymonitor.org">
            <i class="fa fa-comments" aria-hidden="true"></i><span class="navname">&nbsp;Community</span>
          </a>
        </li>
        <li title="you are here: keep up with new developments at OpenEnergyMonitor" class="actoemLink">
          <a href="https://blog.openenergymonitor.org">
            <i class="fa fa-bullhorn" aria-hidden="true"></i><span class="navname">&nbsp;Blog</span>
          </a>
        </li>
        <li title="the official OpenEnergyMonitor online store">
          <a href="https://shop.openenergymonitor.com">
            <i class="fa fa-shopping-cart" aria-hidden="true"></i><span class="navname">&nbsp;Shop</span>
          </a>
        </li>
				<li title="search for something on OpenEnergyMonitor">
					<a class="searchIcon">
					    <i aria-hidden="true" class="fa fa-search"></i><span class="navname">&nbsp;Search</span>
				  </a>
				</li>
      </ul>
    </div>
  </div>
</div>
<div class="searchBox">
  <form target="_blank" id="searchform" action="https://www.google.com/cse">
    <div>
      <input type="hidden" name="cx" value="006198118389747886812:_nmxikw563w" />
      <input type="hidden" name="ie" value="UTF-8" />
      <input type="text" class="searchText" value="" name="q" id="q" autocomplete="off" />
      <input type="submit" id="searchsubmit" name="sa" value="Search" />
    </div>
  </form>
</div>
<div class="blackOut"></div>
<div style="position:relative;width:100%;top:0;height:20px"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script defer src="/javascripts/octopress.js"></script>

<script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

<script>

var closeStatus = false;

function openButton() {
  $("html, body").addClass("menuFreeze");
  $(".blackOut").show();
  $(".navigation").show();
  $(".navigation").animate({ width:'180' },"0.5s");
}

$(".fa-navicon").click(function() {
  openButton();
  closeStatus = true;
});

function closeButton() {
  $("html, body").removeClass("menuFreeze");
  $(".blackOut").hide();
  $(".navigation").animate({ width:'0' },"0.5s");
}

$(".blackOut").click(function() {
  closeButton();
  closeStatus = false;
});

$(document).ready(function(){
  $("table").wrap("<div style='max-width:100%;overflow-x:auto'></div>");
});

$(window).resize(function(){
  if ($(window).width() > 1079 && closeStatus == true) {
    if (!$("html").hasClass("mobile-device")) {
      closeButton();
      closeStatus = false;
    }
  }
});

$(".searchIcon").click(function() {
   $(".searchBox").css("display","flex");
   $(".searchText").animate({width: "200px"});
   $(".searchText").focus();
   $("html, body").addClass("menuFreeze");
});
$(".searchBox").click(function() {
   $(".searchBox").css("display","none");
   $(".searchText").blur();
   $(".searchText").css("width","0");
   closeButton();
});
$(".searchBox form").click( function(event) {
   event.stopPropagation();
});

$(document).ready(function(){ //alphabetically order list
  var ls, x, switchState, z, switchMe;
  ls = document.getElementById("ub202");
  switchState = true;
  while (switchState) {
    switchState = false;
    z = ls.getElementsByTagName("LI");
    for (x = 0; x < (z.length - 1); x++) {
      switchMe = false;
      if (z[x].innerHTML.toLowerCase() > z[x + 1].innerHTML.toLowerCase()) {
        switchMe= true;
        break;
      }
    }
    if (switchMe) {
      z[x].parentNode.insertBefore(z[x + 1], z[x]);
      switchState = true;
    }
  }
});

</script>

<div class="grid-wrapper">
  <div class="grid grid-center">
    
    <div class="grid__item two-thirds lap-one-whole palm-one-whole">
    

        
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/testing-ds18b20-temperature-sensing-on/">Testing DS18B20 temperature sensing on emonTx v3</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-25T09:34:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-25 09:34:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>temperature</li>
      
        <li>emonTx</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/testing-ds18b20-temperature-sensing-on/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <div class="separator" style="clear: both; text-align: left;">Hello, so I thought Id try something new on this blog, I'm going to try writing short blog posts about progress and general work on things day to day, these are not intended to mark significant developments or milestones which many of the other blog posts have tended to be, something more like a log book that will hopefully give insight into the development process.</div><br /><b>Testing DS18B20 temperature sensing on emonTx v3</b><br /><br />Glyn and I with help from Robert are continuing with testing emontx V3, there have been a few niggling issues that we're working on but its pretty much there. This morning I tested the DS18B20 temperature sensor connection, it all worked fine, one of the nice things of the new emontx is that there are screw terminals for connecting up the temperature sensor which makes connecting up the encapsulated DS18B20 temperature sensors much easier.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-ffiA6kvc8Gk/UZ6qIJqbXvI/AAAAAAAACms/2qOL0QhZnZs/s1600/2013-05-24+00.40.45.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto; text-align: center;"><img border="0" height="180" src="http://1.bp.blogspot.com/-ffiA6kvc8Gk/UZ6qIJqbXvI/AAAAAAAACms/2qOL0QhZnZs/s320/2013-05-24+00.40.45.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">DS18B20 connected to emontx v3</td></tr></tbody></table>Another new addition for temperature sensing is the ability to switch the sensor power pin on and off for use when powering the emontx of batteries (this avoids the hack introduced in the low power temperature node that uses the emontx v2.2 pcb). Anyway the circuit was originally designed with analog 5 (used as digital pin 19) being used for data and digital 5 used for power. While reading about using analog inputs as digital pins I came across this note on the arduino site:<br /><br /><i>The Atmega datasheet also cautions against switching analog pins in<br />close temporal proximity to making A/D readings (analogRead) on other<br />analog pins. This can cause electrical noise and introduce jitter in<br />the analog system. It may be desirable, after manipulating analog pins<br />(in digital mode), to add a short delay before using analogRead() to<br />read other analog pins.</i><br /><br />It turns out one can just switch the atmega pins used around so analog 5 (digital 19) is used for power and digital 5 is used for the data which will be higher frequency switching and so good to bring that off the analog pin. As power switching is only needed in battery operation one could make a temperature measurement after the analog read section just before putting the emontx to sleep which should not cause interference.<br /><br /><b>Update (15/06/13): On future emonTx V3 PCB revisions 3.x ADC 5 (Dig 19) and Dig5 have been swapped round on the PCB to fix this issue. Dig 5 is now DS18B20 one-wire signal and ADC5 (Dig19) is now DS18B20 power.</b><br /><b><br /></b><b>If no DS18B20 temperature sensor is connected the ports can be used for other functions. ADC 5 can be used as a analogue input/output and Dig 5 (with R27/R24 4.7K pull up removed) can be used as a general Digital I/O with PWM&nbsp;capabilities.&nbsp;</b><br /><b><br /></b><b>The DS18B20 data 4.7K pull-up resistor on Dig 5 and the Dig 2 IRQ 10K pull-down resistor have been designed to take a thru-hole resistor if the SMT resistor was removed to make it possible to change the value of these resistors.&nbsp;</b>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/open-source-hardware-users-group-oshug/">Open Source Hardware Users Group (OSHUG) #26 Meetup </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-17T07:45:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-17 07:45:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>presentation</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/open-source-hardware-users-group-oshug/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Last night I attended<a href="http://oshug.org/event/26"> OSHUG event #26</a>&nbsp;in London and gave a short talk on Low Power Wireless sensors as well as the brief overview of the OpenMonitorProject and a quick look at what we've been working on recently.<br /><br />There are a couple of new screenshots in the presentation from the open-source <a href="http://emoncms.org/sap/introduction">SAP building&nbsp;modelling&nbsp;emoncms module</a> that Trystan is been working in with Manchester&nbsp;<a href="http://twitter.com/CarbonCoop">@CarbonCoop</a>&nbsp;recently. This is an exciting bit of development. The idea is that the building model could be matched up to the monitoring results (temperature profile &amp; heat input) of a building, the model could then be used to investigate the effect of undertaking improvement measures such as wall, loft insulation or external&nbsp;cladding&nbsp;etc.. Finally after&nbsp;completion&nbsp;of improvement measures the monitoring data can again be used to evaluate the actual performance of the improvement measures.<br /><br /><iframe allowfullscreen="" frameborder="0" height="356" marginheight="0" marginwidth="0" mozallowfullscreen="" scrolling="no" src="http://www.slideshare.net/slideshow/embed_code/21307459" style="border-width: 1px 1px 0; border: 1px solid #CCC; margin-bottom: 5px;" webkitallowfullscreen="" width="427"> </iframe><br /><div style="margin-bottom: 5px;"><strong> <a href="http://www.slideshare.net/OpenEnergyMonitor/osug-26-low-power-wireless-sensors" target="_blank" title="Osug #26 low power wireless sensors">Osug #26 low power wireless sensors</a> </strong> from <strong><a href="http://www.slideshare.net/OpenEnergyMonitor" target="_blank">OpenEnergyMonitor</a></strong> <br /><br />It was great to meet everyone and put faces to (twitter) names! Big thanks to Andrew Back&nbsp;<a href="https://twitter.com/9600">@9600</a>&nbsp;for organising the event and&nbsp;<a href="https://twitter.com/skpang_uk">@skpang_uk</a>&nbsp;for&nbsp;sponsoring the event...and buying me a beer afterwards!&nbsp;&nbsp;</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/one-year-of-solar-pv-monitoring/">One Year of Solar PV Monitoring</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-13T20:27:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-13 20:27:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>renewable</li>
      
        <li>benchmarking</li>
      
        <li>solarPV</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/one-year-of-solar-pv-monitoring/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <div class="separator" style="clear: both; text-align: left;">On the 23rd November 2011 we have had a 2.9Kwp solar PV installed.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-6Zd9PL-5AJE/UZEzH7aGB9I/AAAAAAAAeog/-tocRt1M_OA/s1600/Panels.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="177" src="http://3.bp.blogspot.com/-6Zd9PL-5AJE/UZEzH7aGB9I/AAAAAAAAeog/-tocRt1M_OA/s320/Panels.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">We recently got our first payment from the<a href="http://www.fitariffs.co.uk/eligible/levels/">&nbsp;UK's&nbsp;governments&nbsp;Feed In Tariff</a>&nbsp;scheme.&nbsp;This has prompted me to take stock of how the system has been performing and how the data collected using the OpenEnergyMonitor energy monitoring system compares to the utility&nbsp;company's&nbsp;billing meter:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both;">From the 23rd Nov 2011 - 23rd Nov 2012 the billing utility meter on the solar PV system has recorded a &nbsp;<b>generation of 2069 kWh</b>. Over the same period we consumed 3588&nbsp;Kwh, <b>57% of our electrical energy needs have been met by the solar PV.&nbsp;</b></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">At this rate it looks like we're on track for the system to pay back in 7-8 years, maybe even less if we have some more sun in the next few years, fingers crossed!&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">For the same time period the OpenEnergyMonitor monitoring system has recorded a generation of 2029 kWh, giving the <b>energy monitor an accuracy of 98%!&nbsp;</b></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The monitoring system is a standard&nbsp;<a href="http://shop.openenergymonitor.com/solar-pv-monitor-kit-bundle-433mhz-euro-plug/">emonTx with an AC-AC adapter taking Real Power readings</a>.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-BSjVQR4ViYY/UZFElq6OGdI/AAAAAAAAeow/VV4iTj7-PmI/s1600/Selection_014.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="276" src="http://1.bp.blogspot.com/-BSjVQR4ViYY/UZFElq6OGdI/AAAAAAAAeow/VV4iTj7-PmI/s640/Selection_014.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">One Year of PV Generation</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-aBI-v-iDQ9Q/UZHtMP1ludI/AAAAAAAAepM/zz59PUGZ0lE/s1600/Selection_015.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="228" src="http://2.bp.blogspot.com/-aBI-v-iDQ9Q/UZHtMP1ludI/AAAAAAAAepM/zz59PUGZ0lE/s640/Selection_015.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Kwh/d Electricity Consumption (orange) Overlaid&nbsp;with Generation (blue)&nbsp;</td></tr></tbody></table><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">When the system was installed the solar PV company&nbsp;estimated&nbsp;we would produce&nbsp;2434 Kwh per year, we generated 15% less than this estimate. This could partly be&nbsp;attributed&nbsp;to the very poor summer we&nbsp;experienced&nbsp;in 2012.</div><div><span style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 13px;"><br /></span></div><div class="separator" style="clear: both; text-align: left;">This year is already looking promising, on the 2nd of May 2013 our system generated a record (for us) of 18.3 Kwh 1.9 times more than we consumed on that day (9.7 Kwh):</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-XTd1UQbWGI4/UZEv6lkOiTI/AAAAAAAAeoU/EFmdCDAIG9I/s1600/New+PV+record+2nd+May+2013.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://4.bp.blogspot.com/-XTd1UQbWGI4/UZEv6lkOiTI/AAAAAAAAeoU/EFmdCDAIG9I/s640/New+PV+record+2nd+May+2013.png" width="451" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Record Generation on 2nd May 2013</td></tr></tbody></table>Fingers&nbsp;crossed&nbsp;for a sunny 2013 summer!
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/carbon-coop/">Carbon Coop</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-03T15:27:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-03 15:27:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>sustainability</li>
      
        <li>workshop</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/carbon-coop/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    The weekend before last I went to Manchester to help Matt Fawcett and Jonathan Atkinson of Carbon coop with the&nbsp;<a href="http://carbon.coop/news/2013-04-03/ecohome-lab-launch-workshop-build-day-first-meet">EcoHome_Lab</a> openenergymonitor energy monitor building workshop. I haven’t blogged about Carbon Co-op before so Id like to give a bit of an intro to who they are and why I think what they are doing is particularly exiting.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-bAdkFqme1Bk/UYPA0JtMAkI/AAAAAAAACks/fuLZUpwBCdc/s1600/2013-04-26+12.56.04.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="188" src="http://1.bp.blogspot.com/-bAdkFqme1Bk/UYPA0JtMAkI/AAAAAAAACks/fuLZUpwBCdc/s640/2013-04-26+12.56.04.jpg" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><a href="http://carbon.coop/">http://carbon.coop</a></td></tr></tbody></table>I first met <a href="http://openenergymonitor.org/emon/user/1510">Matt</a> who is&nbsp;responsible for the monitoring&nbsp;at Carbon Coop at a <a href="http://www.cleanweb.org.uk/">Cleanwebuk</a> event in London after initially exchanging a few emails. Matt explained that they are working on a retrofit programme to try to prove that it is possible to cut between 60-80% of energy demand from homes because this is what we need to save.<br /><div><div><br />They want monitoring to be at the centre of everything they do, so that their members can see how minor changes impact energy usage as well as more major retrofit changes. They also want to monitor internal air quality as well as temperature for early identification of any problems with the insulation and airtightness measures. By monitoring humidity, CO2 as well as temperature Matt explained that its possible to isolate issues around damp/cooking etc from issues around ventilation.<br /><br />They are really keen to use open source technology because that then gives them the freedom to configure the system as they need and then get at the data. They are keen advocates for open data and open source software and hardware in general and carry out their own work in an open way.<br /><br />Since then Carbon Coop have installed 18 openenergymonitor energy monitors in houses across Manchester, held two energy monitor workshops including last weekends and are going forward with retrofitting 15 houses to between 60 and 80% carbon reduction.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-CoqTigz4lPg/UYPCMIHSV2I/AAAAAAAACk4/lJrln547-Uc/s1600/2013-04-20+14.25.30.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto; text-align: center;"><img border="0" height="180" src="http://4.bp.blogspot.com/-CoqTigz4lPg/UYPCMIHSV2I/AAAAAAAACk4/lJrln547-Uc/s640/2013-04-20+14.25.30.jpg" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Building monitors at the Carbon Coop EcoHomeLab workshop 19th-20th April&nbsp;</td></tr></tbody></table>What I really like about Carbon Coop is the way they are working on every part of the process: They start with the larger picture of what we need to do in terms of sustainable energy in housing and then go from there to work on an individual household basis, first carrying out a detailed whole house assessment based on the governments SAP (standard assessment procedure) to identify where most energy is being lost, which improvements would have the biggest effect and what to do first. They’re using the energy monitoring to provide feedback to households as described above. From there they go on to help households carry out work on their houses, from finding the best way to finance retrofit measures to working with architects and local tradespeople. Once the retrofit building works are complete they continue to monitor to ensure that the changes reach the predicted energy targets. They do all this using an open source approach, they are also a co-operative that is open for people to join. They are a really switched on group of people, carrying out their work in a thorough, thoughtful, evidence based way.<br /><br />Every-time I go to visit them I come back inspired to develop things further. One of the highlights of the last visit was listening to Eleni Kalkantzi who works for URBED (Carbon Coop's technical partner) talk about the whole house assessment methodology and reports she, Charlie Baker and Marianne Heaslip have developed. A huge amount of work has clearly gone into these reports and the assessment method, they have an example report and report on the assessment method here:<br /><br />See their example assessment here: <a href="http://carbon.coop/assessments/CC_EXAMPLE_ASSESSMENT2.pdf">http://carbon.coop/assessments/CC_EXAMPLE_ASSESSMENT2.pdf</a><br /><br />Report on the assessment method: <a href="http://carbon.coop/assessments/URBED_ASSESSMENT_REPORT.pdf">http://carbon.coop/assessments/URBED_ASSESSMENT_REPORT.pdf</a><br /><br />They see the next step being to integrate monitoring data directly in to the SAP model on which their reporting is based to reduce the number of assumptions made. This is where the <a href="http://github.com/emoncms/sap">open source emoncms SAP model</a>&nbsp;that we have been developing comes in but I will come back to that in another post.</div></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/04/introducing-rfm12pi-v2-raspberry-pi/">Introducing the RFM12Pi V2 - Raspberry Pi Wireless Expansion Board </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-04-26T18:25:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-04-26 18:25:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>RFM12</li>
      
        <li>raspberry pi</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/04/introducing-rfm12pi-v2-raspberry-pi/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Since, November last year we have more and more been leaning towards using a Raspberry Pi as our web connected base station of choice. See&nbsp;<a href="http://openenergymonitor.blogspot.com/2012/11/raspberry-pi-emonbase.html">here</a>&nbsp;for our original&nbsp;blog post on using the Raspberry Pi as an emoncms logging &nbsp;and visualisation&nbsp;server.<br /><br />Here is the latest version of the RFM12Pi Raspberry Pi wireless expansion board. Like the V1 the RFM12Pi V2 allows the Raspberry Pi to receive and transmit data via RFM12B 433/868mhz from and to other wireless nodes such as the <a href="http://openenergymonitor.org/emon/emontx">emonTx</a>, <a href="http://openenergymonitor.org/emon/emonglcd">emonGLCD</a> and <a href="http://openenergymonitor.org/emon/emontx/tempnode">Remote Temperature</a> nodes.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-jaZMslEY3zA/UXXFwc4uSDI/AAAAAAAAee8/vqDdsJqPCGo/s1600/RFM12PiV2_Pi_small.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="256" src="http://3.bp.blogspot.com/-jaZMslEY3zA/UXXFwc4uSDI/AAAAAAAAee8/vqDdsJqPCGo/s400/RFM12PiV2_Pi_small.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">RFM12Pi V2 - Raspberry Pi Expansion Board</td></tr></tbody></table><br />The RFM12Pi V2 is now&nbsp;<a href="http://shop.openenergymonitor.com/raspberry-pi/">for sale in the OpenEnergyMonitor online shop</a>, it comes pre-assembled and ready loaded with firmware, when used in conjunction with the read-to-go emoncms Raspberry Pi SD card image&nbsp;it makes for a truly plug-and-play energy monitor web-connected base-station setup. We're also selling a PCB only version and of course the hardware design, Arduino based firmware all Raspberry Pi emoncms setup is all open-source.<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-kvaEcEb-_YM/UZFQNVhLKrI/AAAAAAAAeo8/eclD4tkXnAI/s1600/RFM12PiV2_Top_angle_small.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/-kvaEcEb-_YM/UZFQNVhLKrI/AAAAAAAAeo8/eclD4tkXnAI/s200/RFM12PiV2_Top_angle_small.png" width="180" /></a><a href="http://4.bp.blogspot.com/-hGz4QEGTlGA/UXbtEK_0XqI/AAAAAAAAefc/F0YfFncPEVE/s1600/RFM12PiV2_bottom.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="165" src="http://4.bp.blogspot.com/-hGz4QEGTlGA/UXbtEK_0XqI/AAAAAAAAefc/F0YfFncPEVE/s200/RFM12PiV2_bottom.png" width="200" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">For the ultimate super-quick and easy setup we have also made available <a href="http://shop.openenergymonitor.com/emoncms-pre-loaded-raspberry-pi-4gb-sd-card/">pre-loaded Emoncms Raspberry Pi SD cards</a>.&nbsp;</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-axDPbDuB160/UXrFGNcK-ZI/AAAAAAAAegE/tycnq-iOfzw/s1600/emoncmsPi+SD+CARD.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="190" src="http://4.bp.blogspot.com/-axDPbDuB160/UXrFGNcK-ZI/AAAAAAAAegE/tycnq-iOfzw/s200/emoncmsPi+SD+CARD.png" width="200" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Emoncms Raspberry Pi Pre-loaded SD card&nbsp;</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><br /></div>The new features of the RFM12Pi V2 are:<br /><ul><li>ATmega328 based, has more memory and hardware serial support</li><li>Using the ATmega328 hardware serial (+optiboot) and AVRdude (pre-installed on SD card image) it's possible to upgrade the firmware on the RFM12Pi V2 direct from Raspberry Pi,<a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi"> </a><a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi">instructions are on the wiki</a>.</li><li>Runs on ATmega328 internal 8Mhz oscillator (to save unnecessary components)</li><li>SMT used, board layout is optimised for pick-and-place assembly</li><li>Lower profile to fit inside most Raspberry Pi enclosures</li></ul>See the the <a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2">RFM12Pi V2 wiki </a>for more technical details regarding the hardware and firmware. <br /><br />To get up and running all that's needed is to connect the RFM12Pi onto the Raspberry Pi's GPIO pins, insert the pre-build SD card and bootup the Pi. Once booted up browse to the Pi's local IP address or the host name (<a href="http://emoncmspi/">http://emoncmspi)</a> and then configure the RFM12B network setting from within emoncms.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://openenergymonitor.org/emon/sites/default/files/Raspi_emoncms.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="408" src="http://openenergymonitor.org/emon/sites/default/files/Raspi_emoncms.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emoncms Raspberry Pi Module Config Page</td></tr></tbody></table><br /><br />Monitoring data is logged to the Raspberry Pi's SD card and can be mirrored to <a href="http://emoncms.org/">emoncms.org</a> or any other emoncms server for backup and remote viewing. The Raspberry Pi is powerful enough to be able to serve emoncms graphs and widgets.    <br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><img border="0" src="http://lh3.ggpht.com/-mW_ZAzB018I/UXcDcf8e1fI/AAAAAAAAef0/iiBTxla5bfg/s640/Skitch.png" style="margin-left: auto; margin-right: auto;" /></td></tr><tr><td class="tr-caption" style="text-align: center;">emoncms dashboard served from the Raspberry Pi - viewed on a Nexus 7 Tablet&nbsp;</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><a href="http://lh3.ggpht.com/-mW_ZAzB018I/UXcDcf8e1fI/AAAAAAAAef0/iiBTxla5bfg/s1600/Skitch.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">  </a> </div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/04/pictures-from-openenergymonitor-cat/">Pictures from the OpenEnergyMonitor CAT course</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-04-17T20:56:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-04-17 20:56:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>workshop</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/04/pictures-from-openenergymonitor-cat/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <div class="separator" style="clear: both; text-align: left;">A couple of weeks ago we held our first openenergymonitor course at the Center for Alternative Technology in Mid Wales. It was well attended with 17 of us in total including tutors: myself, Carlos and Suneil. We where also lucky to have Robin Emley come down to demo his MK2 Surplus PV diverter and lend a helping hand.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Here are a few pictures of everyone getting stuck in with building emontx's and rfm12pi adapter boards:</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-SFQZK8DQ0O0/UVn4lifvx_I/AAAAAAAACjE/MIjwWs0p-3A/s1600/2013-03-26+11.37.06.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="180" src="http://2.bp.blogspot.com/-SFQZK8DQ0O0/UVn4lifvx_I/AAAAAAAACjE/MIjwWs0p-3A/s320/2013-03-26+11.37.06.jpg" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">Carlos and Sebastian who came all the way from Germany going through the Raspberry PI setup process:</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-GboPwPV_rgM/UVn4mqVr1kI/AAAAAAAACjM/ypCWHG9sGZU/s1600/2013-03-26+11.36.33.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="180" src="http://2.bp.blogspot.com/-GboPwPV_rgM/UVn4mqVr1kI/AAAAAAAACjM/ypCWHG9sGZU/s320/2013-03-26+11.36.33.jpg" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ow3IK2F_TUI/UVn4nNmmSvI/AAAAAAAACjU/Puf7fgOlGkg/s1600/2013-03-26+11.36.16.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="180" src="http://2.bp.blogspot.com/-ow3IK2F_TUI/UVn4nNmmSvI/AAAAAAAACjU/Puf7fgOlGkg/s320/2013-03-26+11.36.16.jpg" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">Robin Emley helping out above and his solar pv diversion setup below:</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-qfJzJk8XImw/UVn4n3Y1mkI/AAAAAAAACjc/vaNf_9ZJSVI/s1600/2013-03-25+19.34.25.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="180" src="http://4.bp.blogspot.com/-qfJzJk8XImw/UVn4n3Y1mkI/AAAAAAAACjc/vaNf_9ZJSVI/s320/2013-03-25+19.34.25.jpg" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">The course was held in the beautiful Welsh&nbsp;Institute&nbsp;for Sustainable Education (WISE) &nbsp;building at CAT:</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-8PEEv1-emj8/UVqYYV47qPI/AAAAAAAACjs/YKiDI59C8s8/s1600/WISE-building-at-Centre-f-007.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="192" src="http://4.bp.blogspot.com/-8PEEv1-emj8/UVqYYV47qPI/AAAAAAAACjs/YKiDI59C8s8/s320/WISE-building-at-Centre-f-007.jpg" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both;">I'm in Manchester this coming weekend (20th April) helping Matt Fawcett and the rest of the Carbon Coop team with their:&nbsp;<a href="http://carbon.coop/news/2013-04-03/ecohome-lab-launch-workshop-build-day-first-meet">Ecohome lab launch workshop and build day</a>.&nbsp;Looking forward to it.</div><div class="separator" style="clear: both; text-align: center;"><br /></div><br />
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/03/course-at-centre-for-alternative/">Course at the Centre for Alternative Technology</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-03-02T23:21:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-03-02 23:21:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Carlos AG</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>workshop</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/03/course-at-centre-for-alternative/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    by Carlos Alonso Gabizón<br /><h2><style type="text/css"> <!--   @page { margin: 2cm }   P { margin-bottom: 0.21cm }  </style> Open Source Tools For Energy Monitoring</h2><h3 style="margin-bottom: 0cm;">25th - 28th March</h3><h3 style="margin-bottom: 0cm;"></h3><div style="margin-bottom: 0cm;">When working towards sustainable energy it is important that we work towards it in a way that adds up. Energy monitoring is a vital tool for helping us do this from measuring our home electricity consumption to working out the performance of sustainable heating systems.</div><div style="margin-bottom: 0cm;">During this short workshop we will explore and build monitoring solutions that are based on open source technology developed as part of the openenergymonitor.org online research project. Solutions that can be configured for a wide range of applications including:</div><ul><li>Household Electricity monitoring</li><li>Heat-pump monitoring</li><li>Solar PV generation monitoring</li></ul><div style="margin-bottom: 0cm;">The workshop will focus around a practical case study of monitoring electricity generation and use at the Centre for Alternative Technology designing a public energy display to engage visitors that can be accessed both at the site and on the web.</div><h3 style="margin-bottom: 0cm;">Workshop content outline</h3><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-QFgtAhsvzMA/UTKHc6opBhI/AAAAAAAAACE/WG9p-nDTiCs/s1600/content_outline.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="376" src="http://2.bp.blogspot.com/-QFgtAhsvzMA/UTKHc6opBhI/AAAAAAAAACE/WG9p-nDTiCs/s640/content_outline.jpg" width="640" /></a></div><h3 style="margin-bottom: 0cm;">&nbsp;</h3><h3>Course tutors</h3><div style="margin-bottom: 0cm;"><i><b>Carlos Alonso Gabizón</b></i> – Is the course leader. Worked on microgrid energy display project at CAT and open source software for extracting energy data from PV inverter equipment. Carlos has an electronic engineering and computer science background.</div><div style="margin-bottom: 0cm;"><i><b>Trystan Lea</b></i> – As a core developer on the openenergymonitor project Trystan will be introducing the hardware and software workshops. Trystan codeveloped with Glyn Hudson many of the main elements of the openenergymonitor system with a focus on software and firmware including emoncms an open source web application for energy visualisation. Trystan also runs the openenergymonitor kit shop with Glyn Hudson.Trystan has a Physics background with a BSc in Physics at Cardiff University.</div><div style="margin-bottom: 0cm;"><i><b>Suneil Tagore</b></i> – Will be giving an introduction to open source 3D fabrication/printing using the reprap. Suneil has also worked on DC monitoring for theHugh Piggot wind turbine. Suneil has a background in Engineering andcomputer science with an MEng in Engineering at UCL London and a MSc inComputer Science at Cardiff University.</div><h4>Course cost and how to book</h4><div style="margin-bottom: 0cm;">The course cost is £520. Concession: £340 (unemployed, retired or full time student). This covers accommodation, food and course tuition.<br />You can reserve a place on the course online at: <a href="http://courses.cat.org.uk/energyrenewables/open-source-tools-for-energy-monitoring-detail" target="_blank">courses.cat.org.uk/</a> or by phone calling the CAT Courses Department on 01654 704 952.</div><h4>What will you get from this course?</h4><div style="margin-bottom: 0cm;">Firstly, the knowledge and practical skills to build and set up a monitor solution based in the openenergymonitor kit and how to expand its functionality beyond what is done in the course.<br />Secondly, you will be able to install emonCMS, set it up and create really nice visualizations.<br />And lastly but more exciting than the previous, you will take home your own energy monitor completely ready to use!!!</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/02/emontx-smt-update-introducing-emontx-v3/">emonTx SMT update > Introducing emonTx V3 </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-02-10T13:30:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-02-10 13:30:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>emonTxSMT</li>
      
        <li>emonTx</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/02/emontx-smt-update-introducing-emontx-v3/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    If you're a regular follower of our blog you might remember towards the end of the summer of last year (2012) we posted up a&nbsp;<a href="http://openenergymonitor.blogspot.com/2012/08/emontx-smt-progress-update.html">design of an emonTx SMT</a> (pre-assembled using surface mount electronics).<br /><br />Since that original post progress on the new design has been rather slow (I've been trying to document progress on <a href="http://openenergymonitor.org/emon/node/736">this forum thread</a>). Slow progress has mainly been due to the success of the shop! Order fulfilment, stock organisation and <a href="http://openenergymonitor.blogspot.com/2012/12/tax-and-seasons-greetings.html">administration</a> has been taking up most of our time. However, we have built a prototype emonTx SMT with the&nbsp;original design from Aug 2012. The functions tested so far have worked well. Although we are yet to do a proper accuracy test, however we are confident that it will perform well as it's based on the <a href="http://openenergymonitor.blogspot.co.uk/2012/06/high-accuracy-current-measurement-over.html">Atmel energy monitor app note</a>.<br /><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-ZYI2UKpFHyY/UReeAg-0hTI/AAAAAAAAdLU/SXaZZjYRmTI/s1600/emonTxSMT_built.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/-ZYI2UKpFHyY/UReeAg-0hTI/AAAAAAAAdLU/SXaZZjYRmTI/s320/emonTxSMT_built.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emonTx SMT prototype</td></tr></tbody></table><div>The original emonTx SMT was designed with high accuracy and flexibility (everything but the kitchen sink on one PCB!) in mind. However being a complex design with many components assembly costs will be high. At some stage in the future we would like to get it manufactured but we feel that a lower cost less complex board with <a href="http://openenergymonitor.org/emon/emontx/accuracy">comparable performance to the current emonTx</a> but in SMT form and nicely cased will be more&nbsp;suitable as a next step for us. The performance of the current emonTx is adequate for most monitoring applications and with real power monitoring performance is better than most domestic energy monitors currently on the market. <br /><div><br /></div><div>**</div><h3>Introducing the emonTx V3:</h3><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-ME2cdpLXstg/URedGutbYrI/AAAAAAAAdK8/P9YJR4Qm5Ow/s1600/emonTx+SMT+V3+proto+labeled+ports.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="584" src="http://4.bp.blogspot.com/-ME2cdpLXstg/URedGutbYrI/AAAAAAAAdK8/P9YJR4Qm5Ow/s640/emonTx+SMT+V3+proto+labeled+ports.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emonTx V3 prototype CAD design</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><br /></div><div>The form factor is the same as the emonTx SMT design. It's been designed to fit in a wall mountable extruded aluminium case with laser cut plastic fascia for the openings.&nbsp;</div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-mBPt4FAnviU/URebzcYUY-I/AAAAAAAAdKw/n-KSXhdcgBg/s1600/emonTxV3_caseMockup.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="320" src="http://1.bp.blogspot.com/-mBPt4FAnviU/URebzcYUY-I/AAAAAAAAdKw/n-KSXhdcgBg/s320/emonTxV3_caseMockup.jpg" width="237" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emonTx V3 case mockup</td></tr></tbody></table><div><br /></div><div>The energy monitoring parts of the emonTx V3 are the same as the current emonTx but using SMT components. However unlike the original emonTx (V2) we have put effort into designing the PCB with best analogue performance in mind, time will tell if this will result in&nbsp;improved&nbsp;performance:</div><div><br /></div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-JCkJzZhHJgg/URedpzyD9HI/AAAAAAAAdLM/0ac0a4RZtHw/s1600/emonTx+SMT+V3+proto+analogue.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="410" src="http://4.bp.blogspot.com/-JCkJzZhHJgg/URedpzyD9HI/AAAAAAAAdLM/0ac0a4RZtHw/s640/emonTx+SMT+V3+proto+analogue.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emonTx V3&nbsp;analogue&nbsp;performance design considerations&nbsp;</td></tr></tbody></table><div><br />We have added an extra <b>'high sensitivity' reduced range CT channel</b> to be used to monitor up to 4.5kW (@240V). Reducing the monitoring range by using a higher value burden resistor increase the sensitivity when monitoring lower power levels. This channel will be perfect for monitoring single circuits or&nbsp;appliances&nbsp;e.g. solar PV output, heatpump power etc. <br /><br />Like on the emonTx SMT the emonTx V3 will have the option to be <b>powered from a single AC-AC adapter using a AC-DC</b> half-wave rectifier circuit (see blog post <a href="http://openenergymonitor.blogspot.co.uk/2012/05/emontx-single-ac-power-supply.html">part1</a> and<a href="http://openenergymonitor.blogspot.co.uk/2013/01/power-emontx-from-single-ac-power.html"> part2</a>). This circuit has been carefully designed so that it does not effect the quality of the AC sample wave form. Being able to use only one power adapter to power the unit and simultaneously provide an AC voltage sample to be used for Real Power, Vrms, Power Factor and frequency measurements will reduce the cost and overall embodied energy of the system. <br /><br /><b>The 'heart' of the emonTx V3 is provided by an <a href="http://openmicros.org/index.php/articles/88-ciseco-product-documentation/236-rfu328-starter-guide">Rfu</a></b>. An Rfu is a tiny little Atmega328 with a radio in an SMT XBEE footprint (the final design will also have thru-hole Xbee pads).&nbsp;</div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/--86yETfdgik/URebnRDIRxI/AAAAAAAAdKo/M_x7h74lvss/s1600/2013-01-10+19.04.26.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://4.bp.blogspot.com/--86yETfdgik/URebnRDIRxI/AAAAAAAAdKo/M_x7h74lvss/s320/2013-01-10+19.04.26.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Ciseco RFu - ATmega328 plus RFM12B&nbsp;</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://cdn2.bigcommerce.com/server3700/8d73a/products/221/images/457/IMG_5389__35236.1352109163.1280.1280.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="238" src="http://cdn2.bigcommerce.com/server3700/8d73a/products/221/images/457/IMG_5389__35236.1352109163.1280.1280.JPG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Ciseco RFu - ATmega328 witth SRF radio</td></tr></tbody></table><div><br /></div><div>The RFu has been designed and manufactured in the UK by <a href="http://openenergymonitor.blogspot.co.uk/2012/11/ciseco-visit.html">Ciseco</a>. The radio on the Rfu can be an RFM12B or SRF. We will be using the RFM12B, but it's nice to have a 'drop-in' option for a different radio. Using the Rfu makes the emonTx V3 more modular and it will allow us to manufacture the emonTx V3 easier and cheaper. As with the current emonTx the ATmega328 will be programmable using an FTDI and the Arduino IDE.   </div></div><div><br /></div><div>A barebone emonTx V3 prototype PCB arrived from PCB Train over the weekend, if all goes well we should have a working prototype by the end of the week. Fingers crossed!&nbsp;</div><div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-HyAcGlNP_rE/UU9bclRDstI/AAAAAAAAeZE/J9AwbIy00Jc/s1600/emonTxV3_PCB_Front_small.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="326" src="http://1.bp.blogspot.com/-HyAcGlNP_rE/UU9bclRDstI/AAAAAAAAeZE/J9AwbIy00Jc/s400/emonTxV3_PCB_Front_small.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emonTx V3 prototype PCB</td></tr></tbody></table><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div><br /></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/02/ideas-for-improving-emoncms-framework/">Ideas for improving the emoncms framework</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-02-09T18:53:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-02-09 18:53:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> seven minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>emoncms</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/02/ideas-for-improving-emoncms-framework/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    I've been looking again at writing&nbsp;the developer documentation for emoncms, in particular Id like to document how to build the core framework from scratch, explaining the design decisions and implementation of things like the front controller, modules folder structure, MVC pattern.<br /><br />In doing this exercise and reading up more widely about the various parts I started to get ideas for improvements.<br /><h3>1) Changing the controller structure to better reflect the client side javascript nature of views</h3>The first insight I had followed from reading Jean Claude Wipplers post about really going all the way with client side javascript (and server side for that matter :)&nbsp;using&nbsp;angular js and other technologies: <a href="http://jeelabs.org/2013/01/07/technology-decisions/">http://jeelabs.org/2013/01/07/technology-decisions/</a>&nbsp;"...Think about the change in mindset: no server-side templating… n o n e !"<br /><br />Emoncms UI is already largely client-side javascript with javascript making 41% of the emoncms code base. But there are still quite a few parts that are generated by server-side templating - the user account page being one notable example.<br /><br />The framework was initially built with server side templating in mind with the result of the model being passed to a view and the view being constructed with php. The current <a href="http://openenergymonitor.org/emon/node/312">emoncms application architecture</a> documentation page reflects this idea, see the Views section in&nbsp;particular&nbsp;which shows a minimal example of creating a feed list using php.<br /><br />However the way the feed list view is actually made in emoncms is using client side javascript to create a dynamic view that shows the feeds updating in realtime. The feed list data is requested from the server using jquery AJAX every 5 seconds.<br /><br />Letting go of the idea that we might want to do server side php templating for most of the module views and&nbsp;reassessing&nbsp;the framework controller code in particular, the following as described on the controller part of the application architecture page no longer makes much sense:<br /><br />if ($action == 'list' &amp;&amp; $_SESSION['read'])<br />{<br />&nbsp; $feeds = get_user_feeds($_SESSION['userid']);<br /><br />&nbsp; if ($format == 'json') $output = json_encode($feeds);<br />&nbsp; if ($format == 'html') $output = view("feed/list_view.php", array('feeds' =&gt; $feeds));<br />}<br /><br />Here in&nbsp;response&nbsp;to a request from the client for a feed list we first get the data from the model and second either output it as json or wrap it in a view. But if the view no longer needs the feeds array passed to it (as it is getting the feeds data via an AJAX request) it makes no sense for the view to be called after getting the data from the model.<br /><br />So I think a clearer structure for the controller is to divide it into two parts:<br /><br />The first part deals with html page requests and is essentially loading the client side application from the server to the client:<br /><br />if ($format == 'html')<br />{<br />&nbsp; if ($action == 'list') $output = view("feed/list_view.php", array());<br />&nbsp; if ($action == 'view') ...<br />}<br /><br />The second part placed directly below the above in the controller deals with the JSON API to the model<br /><br />if ($format == 'json')<br />{<br />&nbsp; if ($action == 'get') $result = get_feed(get('userid'),get('feedid'));<br />&nbsp; if ($action == 'list') $result = get_user_feeds(get('userid'));<br /><br />&nbsp; $output = json_encode($result);<br />}<br /><div><h3>2) Straight mysqli instead of db.php abstraction</h3>While rewriting the core framework from scratch it hit me that the db.php abstraction I created that converts mysqli class calls into global scope db_query etc functions is not really that useful and probably just confusing. db.php never did anything  useful on top of mysqli like input sanitisation or anything like that so I think it would just be better to write straight mysqli.<br /><br />Which leads on to the next point:<br /><h3>3) Models as classes</h3>After using the mysqli class with the $mysqli-&gt;query() $class-&gt;method() type interface I started to experiment with using php classes for the emoncms models instead of just a file full of functions. Here's an example for the feed class with only one method for loading a users feed list (notice also how $mysqli is passed into the class for use)<br /><br />class Feed<br />{  <br />&nbsp; private $mysqli;<br /><br />&nbsp; public function __construct($mysqli)<br />&nbsp; {<br />&nbsp; &nbsp; $this-&gt;mysqli = $mysqli;<br />&nbsp; }<br /><br />&nbsp; public function list($userid)<br />&nbsp; {    <br />&nbsp; &nbsp; $feeds = array();<br />&nbsp; &nbsp; $result = $this-&gt;mysqli-&gt;query("SELECT * FROM feeds WHERE `userid` = '$userid');<br />&nbsp; &nbsp; while ($row = $result-&gt;fetch_object()) $feeds[] = $row;<br />&nbsp; &nbsp; return $feeds;<br />&nbsp; }<br /><br />}<br /><br />To use this in the application we first create an instance of the class<br /><br />$feed = new Feed($mysqli);<br /><br />and then call the methods needed:<br /><br />$result = $feed-&gt;list($userid);<br /><br />This gives us a nice interface to the feed model in the rest of the application, it's a clearer naming convention model_name-&gt;method_name() and its clearer that model methods and&nbsp;properties belong to that model. There are also a whole load of other potential benefits as time goes on such as extending the class and so on (all standard stuff in most frameworks)<br /><h3>4) The fat model and thin controller</h3>In reading more on the model view controller pattern I came across this article which really made a lot of sense to me: <a href="http://blog.astrumfutura.com/2008/12/the-m-in-mvc-why-models-are-misunderstood-and-unappreciated/">http://blog.astrumfutura.com/2008/12/the-m-in-mvc-why-models-are-misunderstood-and-unappreciated/</a><br /><br />The question of what should be in the controller and what should be in the model is something that I had been a bit unsure about and so far I have usually put input validation and any error reporting in the controller while trying to confine the model to primarily data access.&nbsp;</div><div><br /></div><div>But looking again at this and with the clarity of that article, it makes sense to me that input validation and error reporting should be in the model instead.</div><div><br /></div><div>When coupled with the class based model that model then becomes a very complete and portable class that can be used in different applications or frameworks&nbsp;as the article suggests&nbsp;with all the validation and error reporting intact.<br /><br />The controller's role then becomes:&nbsp;translation of the external http api to model method calls , fetching of input via $_GET and $_POST and passing these to the model method&nbsp;parameters&nbsp;and checking to see if the user has the correct&nbsp;privileges&nbsp;to call the model method.<br /><h3>5) php code formatting standards&nbsp;</h3><div>Here's another interesting resource I came across only yesterday&nbsp;<a href="http://phptherightway.com/">phptherightway.com</a>.&nbsp;There's lots of valuable information on there including details on 4 standards including a code formatting standard for php produced by many of the large php frameworks and application projects, I think it would be good to adopt these in emoncms.</div><div><div><h3><b>On the client&nbsp;</b></h3><div><h3>6) Move all the user interfaces over to client side javascript</h3>As&nbsp;mentioned&nbsp;above emoncms user interfaces are already largely constructed with client side javascript interacting with the server via AJAX requests but there are still several interfaces like the user account page that are constructed using php templating. I'd like to explore ways of modularising the client side code, making the code as clear as possible, it all gets rather complex and a bit messy there pretty fast at the moment. I'm also intrigued to explore AngularJS which Jean Claude Wippler <a href="http://jeelabs.org/2012/12/22/dynamic-web-pages/">is using</a> as that looks like it might be a solution to some of the javascript jquery complexity woes that I have been having.</div><div><h3>Next steps...</h3>One of the good things about the server side changes proposed above is that many of them are only minor changes to&nbsp;existing&nbsp;code and they can be introduced incrementally, so we can run old code alongside new.</div></div></div><div><br /></div><div>My plan is to start by completing the emoncms architecture documentation: how to build the emoncms framework from scratch then go on to convert the user module over to the controller and model design as detailed above and complete a nice javascript enabled user login/register page and a user account and profile page.</div><div><br /></div><div><br /></div></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/02/air-quality-egg-sensor-shield/">Air Quality Egg Sensor Shield</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-02-09T13:36:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-02-09 13:36:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li>Air Quality Egg</li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/02/air-quality-egg-sensor-shield/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    The Air Quality Egg Arduino Shield provides a lower cost way for those of you with a spare Arduino / Nanode(RF) to get started with monitoring air quality and joining in the global air quality crowd sourced data and discussion.<br /><br />The Egg Shield is an Arduino shield with Temperature, Humidity, CO and NO2.<div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-ESjKQXjD43U/URZPeVoEOaI/AAAAAAAAdKM/VoIJnlI0yvs/s1600/AQESensorShield.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://4.bp.blogspot.com/-ESjKQXjD43U/URZPeVoEOaI/AAAAAAAAdKM/VoIJnlI0yvs/s400/AQESensorShield.jpg" width="375" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Air Quality Egg Arduino Sensor Shield<br /></td></tr></tbody></table>The sensor shield uses an ATtiny88 microprocessor to poll data from the sensors.&nbsp;<div><br /></div><div>To get started with the Sensor Shield follow <a href="http://aqe.wickeddevice.com/?page_id=12">these instructions</a>.&nbsp;</div><div><br /></div><div>As always the hardware and software is totally open-source, the hardware PCB CAD design &amp; schematic, ATtiny88 firmware and example Arduino sketches can be found on github:&nbsp;<a href="https://github.com/jmsaavedra/Air-Quality-Egg/">https://github.com/jmsaavedra/Air-Quality-Egg/</a></div><div><br /></div><div>The Air Quality Egg Sensor Shield is now available in the <a href="http://shop.openenergymonitor.com/air-quality-egg-arduino-sensor-shield/">OpenEnergyMonitor shop</a>.&nbsp;</div>
    
  </div>
  </article>
  <hr>
  

  <div class="pagination">
    
      <a class="btn pull-left" href="/posts/21">&larr; Older</a>
    

    
    <a class="btn pull-right" href="/posts/19">Newer &rarr;</a>
    
  </div>


    </div>

    
    <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
      <div class="grid">

 
 <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      
        <li class="post">
          <a href="/2022/04/hardware-development/">Chip Shortage & Hardware Development Update</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2019/10/cydynni-display/">Cydynni emonCMS dashboard on display</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2019/05/emondc/">Introducing emonDC</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2018/11/2018-dev-update/">2018 Development Review</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2018/11/demand-side-response/">Demand Side Response Development</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2018/01/emoncms-theme/">Emoncms Blue Theme</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2018/01/emonpi-remote-access/">emonPi Remote Access with Dataplicity</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/10/iotawatt/">Introducing IoTaWatt</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/08/cydynni-energylocal/">CydYnni – Energy Local, community hydro smart grid</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/08/advances-article/">Advances Wales Magazine Article</a>
        </li>
      
    
  </ul>
</section>
  
  
     <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Categories</h1>
  <ul class="divided" id="ub202">
    
    
      <li>
        <a href="/categories/air-quality-egg/">air quality egg
        </a>
      </li>
    
      <li>
        <a href="/categories/antenna/">antenna
        </a>
      </li>
    
      <li>
        <a href="/categories/building-energy-modelling/">building energy modelling
        </a>
      </li>
    
      <li>
        <a href="/categories/china/">china
        </a>
      </li>
    
      <li>
        <a href="/categories/christmas/">christmas
        </a>
      </li>
    
      <li>
        <a href="/categories/dc/">dc
        </a>
      </li>
    
      <li>
        <a href="/categories/dc-current-sensing/">dc current sensing
        </a>
      </li>
    
      <li>
        <a href="/categories/esp8266/">esp8266
        </a>
      </li>
    
      <li>
        <a href="/categories/htu21d/">htu21d
        </a>
      </li>
    
      <li>
        <a href="/categories/heat-pump/">heat pump
        </a>
      </li>
    
      <li>
        <a href="/categories/kaizen/">kaizen
        </a>
      </li>
    
      <li>
        <a href="/categories/kicad/">kicad
        </a>
      </li>
    
      <li>
        <a href="/categories/mqtt/">mqtt
        </a>
      </li>
    
      <li>
        <a href="/categories/nanoderf/">nanoderf
        </a>
      </li>
    
      <li>
        <a href="/categories/nodered/">nodered
        </a>
      </li>
    
      <li>
        <a href="/categories/oem-labs/">oem labs
        </a>
      </li>
    
      <li>
        <a href="/categories/okg/">okg
        </a>
      </li>
    
      <li>
        <a href="/categories/oscilloscope/">oscilloscope
        </a>
      </li>
    
      <li>
        <a href="/categories/rfm12/">rfm12
        </a>
      </li>
    
      <li>
        <a href="/categories/rfm69/">rfm69
        </a>
      </li>
    
      <li>
        <a href="/categories/rs485/">rs485
        </a>
      </li>
    
      <li>
        <a href="/categories/sap-2012/">sap 2012
        </a>
      </li>
    
      <li>
        <a href="/categories/shw/">shw
        </a>
      </li>
    
      <li>
        <a href="/categories/srf/">srf
        </a>
      </li>
    
      <li>
        <a href="/categories/tasker/">tasker
        </a>
      </li>
    
      <li>
        <a href="/categories/android/">android
        </a>
      </li>
    
      <li>
        <a href="/categories/app/">app
        </a>
      </li>
    
      <li>
        <a href="/categories/application/">application
        </a>
      </li>
    
      <li>
        <a href="/categories/arduino/">arduino
        </a>
      </li>
    
      <li>
        <a href="/categories/award/">award
        </a>
      </li>
    
      <li>
        <a href="/categories/backup/">backup
        </a>
      </li>
    
      <li>
        <a href="/categories/batteries/">batteries
        </a>
      </li>
    
      <li>
        <a href="/categories/benchmarking/">benchmarking
        </a>
      </li>
    
      <li>
        <a href="/categories/build-sesh/">build sesh
        </a>
      </li>
    
      <li>
        <a href="/categories/business/">business
        </a>
      </li>
    
      <li>
        <a href="/categories/ciseco/">ciseco
        </a>
      </li>
    
      <li>
        <a href="/categories/community-energy/">community energy
        </a>
      </li>
    
      <li>
        <a href="/categories/community-smart-grid/">community smart grid
        </a>
      </li>
    
      <li>
        <a href="/categories/continuous-testing/">continuous testing
        </a>
      </li>
    
      <li>
        <a href="/categories/control/">control
        </a>
      </li>
    
      <li>
        <a href="/categories/current-sensor/">current sensor
        </a>
      </li>
    
      <li>
        <a href="/categories/current-transformer/">current transformer
        </a>
      </li>
    
      <li>
        <a href="/categories/dashboard/">dashboard
        </a>
      </li>
    
      <li>
        <a href="/categories/development/">development
        </a>
      </li>
    
      <li>
        <a href="/categories/display/">display
        </a>
      </li>
    
      <li>
        <a href="/categories/diy-drones/">diy drones
        </a>
      </li>
    
      <li>
        <a href="/categories/docker/">docker
        </a>
      </li>
    
      <li>
        <a href="/categories/documentation/">documentation
        </a>
      </li>
    
      <li>
        <a href="/categories/ecohomelab/">ecohomelab
        </a>
      </li>
    
      <li>
        <a href="/categories/efergy/">efergy
        </a>
      </li>
    
      <li>
        <a href="/categories/electronics/">electronics
        </a>
      </li>
    
      <li>
        <a href="/categories/elektrocamp/">elektrocamp
        </a>
      </li>
    
      <li>
        <a href="/categories/email-notifications/">email notifications
        </a>
      </li>
    
      <li>
        <a href="/categories/embodied-energy/">embodied energy
        </a>
      </li>
    
      <li>
        <a href="/categories/emonbase/">emonbase
        </a>
      </li>
    
      <li>
        <a href="/categories/emoncms/">emoncms
        </a>
      </li>
    
      <li>
        <a href="/categories/emonctrl/">emonctrl
        </a>
      </li>
    
      <li>
        <a href="/categories/emondc/">emondc
        </a>
      </li>
    
      <li>
        <a href="/categories/emonglcd/">emonglcd
        </a>
      </li>
    
      <li>
        <a href="/categories/emonsd/">emonsd
        </a>
      </li>
    
      <li>
        <a href="/categories/emonth/">emonth
        </a>
      </li>
    
      <li>
        <a href="/categories/emontx/">emontx
        </a>
      </li>
    
      <li>
        <a href="/categories/emontx-v2/">emontx v2
        </a>
      </li>
    
      <li>
        <a href="/categories/emontxsmt/">emontxsmt
        </a>
      </li>
    
      <li>
        <a href="/categories/emontxshield/">emontxshield
        </a>
      </li>
    
      <li>
        <a href="/categories/emoncms/">emoncms
        </a>
      </li>
    
      <li>
        <a href="/categories/emonesp/">emonesp
        </a>
      </li>
    
      <li>
        <a href="/categories/emonpi/">emonpi
        </a>
      </li>
    
      <li>
        <a href="/categories/emontx/">emontx
        </a>
      </li>
    
      <li>
        <a href="/categories/end-to-end/">end to end
        </a>
      </li>
    
      <li>
        <a href="/categories/energy-monitor/">energy monitor
        </a>
      </li>
    
      <li>
        <a href="/categories/energy-monitoring/">energy monitoring
        </a>
      </li>
    
      <li>
        <a href="/categories/esp8266/">esp8266
        </a>
      </li>
    
      <li>
        <a href="/categories/ev/">ev
        </a>
      </li>
    
      <li>
        <a href="/categories/feed-storage/">feed storage
        </a>
      </li>
    
      <li>
        <a href="/categories/firmware/">firmware
        </a>
      </li>
    
      <li>
        <a href="/categories/forum/">forum
        </a>
      </li>
    
      <li>
        <a href="/categories/github/">github
        </a>
      </li>
    
      <li>
        <a href="/categories/graphing/">graphing
        </a>
      </li>
    
      <li>
        <a href="/categories/hackathon/">hackathon
        </a>
      </li>
    
      <li>
        <a href="/categories/hall-effect/">hall effect
        </a>
      </li>
    
      <li>
        <a href="/categories/hardware/">hardware
        </a>
      </li>
    
      <li>
        <a href="/categories/heating/">heating
        </a>
      </li>
    
      <li>
        <a href="/categories/heatpumpmonitor/">heatpumpmonitor
        </a>
      </li>
    
      <li>
        <a href="/categories/home-assistant/">home assistant
        </a>
      </li>
    
      <li>
        <a href="/categories/home-camp/">home camp
        </a>
      </li>
    
      <li>
        <a href="/categories/humidity/">humidity
        </a>
      </li>
    
      <li>
        <a href="/categories/integrations/">integrations
        </a>
      </li>
    
      <li>
        <a href="/categories/interface/">interface
        </a>
      </li>
    
      <li>
        <a href="/categories/interview/">interview
        </a>
      </li>
    
      <li>
        <a href="/categories/iotawatt/">iotawatt
        </a>
      </li>
    
      <li>
        <a href="/categories/java/">java
        </a>
      </li>
    
      <li>
        <a href="/categories/job/">job
        </a>
      </li>
    
      <li>
        <a href="/categories/kickstarter/">kickstarter
        </a>
      </li>
    
      <li>
        <a href="/categories/lightwaverf/">lightwaverf
        </a>
      </li>
    
      <li>
        <a href="/categories/linux/">linux
        </a>
      </li>
    
      <li>
        <a href="/categories/logo/">logo
        </a>
      </li>
    
      <li>
        <a href="/categories/manufacturing/">manufacturing
        </a>
      </li>
    
      <li>
        <a href="/categories/measurement/">measurement
        </a>
      </li>
    
      <li>
        <a href="/categories/media/">media
        </a>
      </li>
    
      <li>
        <a href="/categories/mobile/">mobile
        </a>
      </li>
    
      <li>
        <a href="/categories/mobile-app/">mobile app
        </a>
      </li>
    
      <li>
        <a href="/categories/modbus/">modbus
        </a>
      </li>
    
      <li>
        <a href="/categories/nanode/">nanode
        </a>
      </li>
    
      <li>
        <a href="/categories/ook/">ook
        </a>
      </li>
    
      <li>
        <a href="/categories/open-source/">open source
        </a>
      </li>
    
      <li>
        <a href="/categories/openhab/">openhab
        </a>
      </li>
    
      <li>
        <a href="/categories/openenergymonitor/">openenergymonitor
        </a>
      </li>
    
      <li>
        <a href="/categories/openevse/">openevse
        </a>
      </li>
    
      <li>
        <a href="/categories/optical-pulse/">optical pulse
        </a>
      </li>
    
      <li>
        <a href="/categories/pcb/">pcb
        </a>
      </li>
    
      <li>
        <a href="/categories/pebble/">pebble
        </a>
      </li>
    
      <li>
        <a href="/categories/placement/">placement
        </a>
      </li>
    
      <li>
        <a href="/categories/platformio/">platformio
        </a>
      </li>
    
      <li>
        <a href="/categories/pluse/">pluse
        </a>
      </li>
    
      <li>
        <a href="/categories/presentation/">presentation
        </a>
      </li>
    
      <li>
        <a href="/categories/raspberry-pi/">raspberry pi
        </a>
      </li>
    
      <li>
        <a href="/categories/raspberry-pi/">raspberry pi
        </a>
      </li>
    
      <li>
        <a href="/categories/renewable/">renewable
        </a>
      </li>
    
      <li>
        <a href="/categories/serial/">serial
        </a>
      </li>
    
      <li>
        <a href="/categories/shop/">shop
        </a>
      </li>
    
      <li>
        <a href="/categories/showcase/">showcase
        </a>
      </li>
    
      <li>
        <a href="/categories/smartwatch/">smartwatch
        </a>
      </li>
    
      <li>
        <a href="/categories/social-energy-monitoring/">social energy monitoring
        </a>
      </li>
    
      <li>
        <a href="/categories/solarpv/">solarpv
        </a>
      </li>
    
      <li>
        <a href="/categories/sparkfun/">sparkfun
        </a>
      </li>
    
      <li>
        <a href="/categories/sustainability/">sustainability
        </a>
      </li>
    
      <li>
        <a href="/categories/temperature/">temperature
        </a>
      </li>
    
      <li>
        <a href="/categories/three-phase/">three phase
        </a>
      </li>
    
      <li>
        <a href="/categories/travisci/">travisci
        </a>
      </li>
    
      <li>
        <a href="/categories/tutorials/">tutorials
        </a>
      </li>
    
      <li>
        <a href="/categories/upgrade/">upgrade
        </a>
      </li>
    
      <li>
        <a href="/categories/user-guide/">user guide
        </a>
      </li>
    
      <li>
        <a href="/categories/utility-meters/">utility meters
        </a>
      </li>
    
      <li>
        <a href="/categories/voltage-sensing/">voltage sensing
        </a>
      </li>
    
      <li>
        <a href="/categories/vrms/">vrms
        </a>
      </li>
    
      <li>
        <a href="/categories/website/">website
        </a>
      </li>
    
      <li>
        <a href="/categories/wifipixel/">wifipixel
        </a>
      </li>
    
      <li>
        <a href="/categories/wind/">wind
        </a>
      </li>
    
      <li>
        <a href="/categories/wind-turbine/">wind turbine
        </a>
      </li>
    
      <li>
        <a href="/categories/wireless/">wireless
        </a>
      </li>
    
      <li>
        <a href="/categories/workshop/">workshop
        </a>
      </li>
    
      <li>
        <a href="/categories/zerocarbonbritain/">zerocarbonbritain
        </a>
      </li>
    
  </ul>
</section>
  
</div>
    </aside>
    
  </div>
</div>

<footer>
  <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright">

  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor/guide'><i class="icon-github"></i></a>
  <a rel="me" href='https://blog.openenergymonitor.org/feed.xml'><i class="icon-rss"></i></a>

  <div class="credit" style="text-align:center;">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and <a href='https://github.com/coogie/oscailte'>Oscalite</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>
<!--
<div class="searchtool">


<form action="https://encrypted.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.openenergymonitor.org" />
    <input class="search" id="search" type="text" name="q" results="0" placeholder="Search..." />
  </fieldset>
</form>


</div> -->
</div>
    </div>
  </div>
</div>
</footer>

<!--[if lt IE 7]>
  <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
<![endif]-->

</body>
</html>
